<div id="content" class="span9 favorites-index">
  <h2><%= display_user_name(@user) %><span class="lowercase">'s</span> <%=t('revs.favorites.head')%></h2>

  <% if @favorites.count > 0%>
    <!-- span below is placeholder. this is how it should look, but needs to use real pagination -->
    <span class="prev-next">   
       <%= paginate @favorites, :params => {:order=>@order} %>
    </span>
    <div class="saved-items">
     
        <% @favorites.each do |favorite| %>
          <div class="row item">
            <div class="span5">
              <ul>
                <li><%= link_to(image_tag(favorite.solr_document.images.first), item_path(favorite.solr_document)) %><li>
                <li class="item-title"><%= item_link(favorite.solr_document) %></li>
                <li class="item-creation-date">Saved on <%= show_as_datetime(favorite.created_at.in_time_zone) %></li>
                <li class="favorite-item-actions">
                  <%if can? :destroy, favorite%>
                  <%=button_to("#{t('revs.favorites.remove_from_favorites')}", saved_item_path(favorite.solr_document.id), :method=> :delete, class: 'btn btn-link') %> 
                  <% end %>
                  <% if (can? :destroy, favorite) and (can? :update, favorite) %>
                  |
                  <% end %>
                  <% if can? :update, favorite%>
                  <!-- this link should turn on edit mode for annotation field below -->
                  <%= link_to "#{t('revs.favorites.edit_annotation')}", "/user/#{@name}/favorites/edit/"+favorite.solr_document.id+"#"%>
                  <% end%>
                </li>
              </ul>
            </div>
            <div class="span4">
              <!-- Content of this p needs to be replaced with 'favorite.description' -->
              <% if favorite.druid != params[:editable] or not can? :update, favorite%>
              <p class="item-annotation">
                <%=favorite.description%>                
              </p>
              
              <% else %>
                <%= form_for(favorite, :remote=>true) do |f| %>
                  <%= f.label t('revs.annotations.singular')%>
                  <%= f.text_area :description, :rows => '2', :class => "input-xlarge", :value=>favorite.description %>
                  <%= f.submit t('revs.nav.update'), :class => "flag-button btn btn-small" %>
                <% end %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>

   <% else %>
      <%=t('revs.favorites.none')%>
   <% end %>

   <div class="span9 pagination">
     <%= paginate @favorites %>
   </div>

</div>

<%= render :partial => 'side_nav' %>
