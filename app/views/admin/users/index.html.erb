<div id="content" class="span9 admin">

  <h2>Administrator Dashboard</h2>

  <h3>Administer Users</h3>

  <%= form_tag admin_users_path, :method=>:get, :class => 'form-search' do %>
    <%= text_field_tag :email, @email, :class => 'input-large', :placeholder => 'enter email address' %>
    <%= submit_tag 'Search by email', :class => 'btn btn-small' %>
  <% end %>

  <% if @users.size > 0 %>
    <%= paginate @users, :params => {:order=>@order} %>
    <table class="admin table table-bordered table-condensed table-hover table-striped">
      <tr>
        <th><%= link_to 'Email address', admin_users_path(:order=>'email',:email=>@email) %></th>
        <th><%= link_to 'Username', admin_users_path(:order=>'username',:email=>@email) %></th>
        <th><%= link_to 'Name', admin_users_path(:order=>'last_name',:email=>@email) %></th>
        <th><%= link_to 'Stanford?', admin_users_path(:order=>'sunet',:email=>@email) %></th>
        <th><%= link_to 'Role', admin_users_path(:order=>'role asc',:email=>@email) %></th>
        <th><%= link_to 'Registered on', admin_users_path(:order=>'created_at desc',:email=>@email) %></th>
        <th class="centered"><%= link_to 'Confirmed?', admin_users_path(:order=>'confirmed_at desc',:email=>@email) %></th>
        <th class="centered">Actions</th>
      </tr>
      <% @users.each do |user|%>
       <tr>
         <td><%= user.email%></td>
				 <td><%= user.username %></td>
				 <td><%= user.full_name %></td>
				 <td><%= user.sunet_user? ? "yes" : "no"%></td>
         <td><%= user.role %></td>
         <td><%= show_as_datetime(user.created_at.in_time_zone) %></td>
         <td class="centered"><%= user.confirmed_at.blank? ? "no" : "yes" %></td>
         <td class="centered"><%= link_to '[edit]', edit_admin_user_path(user.id),:id=>"edit-#{user.id}" %></td>
       </tr>
      <% end %>
    </table>

  <% else %>
    No users were found <%="with an email address of #{@email}" if @email %>
  <% end %>

</div>

<%= render :partial => 'devise/shared/show_admin_sidebar' %>
