<div id="content" class="span9 admin">

  <h2><%= t('revs.user.admin_dashboard') %></h2>

  <h3><%= t('revs.admin.administer_users') %></h3>
  <%= form_tag admin_users_path, :method=>:get, :class => 'form-search' do %>
    <%= text_field_tag :search, @search, :class => 'input-large' %>
    <%= submit_tag t('revs.admin.search_by_email'), :class => 'btn btn-small' %>
  <% end %>

  <% if @users.size > 0 %>
    <%= paginate @users, :params => {:order=>@order} %>
  	<%= form_tag(bulk_update_role_admin_users_path, method: 'post', class:'form-inline') do %>
    <p><%=t('revs.admin.set_checked_users')%> <%= select_tag 'role',options_for_select(User.roles,@role),class:"span2"%> <%= submit_tag t('revs.nav.update'), :class => 'btn btn-small' %>
      <!--<input type="checkbox" name="select-all" id="admin-select-all-users"> --> <%#=t('revs.nav.select_all')%> 
    </p>
    <table id="admin-users" class="admin table table-bordered table-condensed table-hover table-striped">
      <tr>
        <th><%= link_to t('revs.user.email_address'),
                admin_users_path(:order=>'email',:serach=>@search) %></th>
        <th><%= link_to t('revs.authentication.username'),
                admin_users_path(:order=>'username',:serach=>@search) %></th>
        <th><%= link_to t('revs.admin.name'),
                admin_users_path(:order=>'last_name',:serach=>@search) %></th>
        <th class="centered"><%= link_to t('revs.admin.stanford'),
                admin_users_path(:order=>'sunet',:serach=>@search) %></th>
        <th><%= link_to t('revs.admin.role'),
                admin_users_path(:order=>'role asc',:serach=>@search) %></th>
        <th><%= link_to t('revs.admin.registered_on'),
                admin_users_path(:order=>'created_at desc',:serach=>@search) %></th>
        <th class="centered"><%= link_to t('revs.admin.confirmed'),
                admin_users_path(:order=>'confirmed_at desc',:serach=>@search) %></th>
        <th class="centered"><%=t('revs.authentication.sidebar.actions')%></th>
        <th class="centered">&nbsp;</th>
      </tr>
      <% @users.each do |user|%>
       <tr>
         <td><%= user.email%></td>
         <td><%= user.username %></td>
         <td><%= user.full_name %></td>
         <td class="centered"><%= user.sunet_user? ? t('revs.messages.switch_yes') : t('revs.messages.switch_no') %></td>
         <td><%= user.role %></td>
         <td><%= show_as_datetime(user.created_at.in_time_zone) %></td>
         <td class="centered"><%= user.confirmed_at.blank? ? t('revs.messages.switch_no') : t('revs.messages.switch_yes') %></td>
         <td class="centered"><%= link_to "[#{t('revs.actions.edit')}]", edit_admin_user_path(user.id),:id=>"edit-#{user.id}" %></td>
         <td class="centered"><%= check_box_tag 'selected_users[]', user.id, false, :id=>"bulk_edit_selected_users_#{user.id}"  %>
          </td>
       </tr>
      <% end %>
    </table>
    
    <% end %>

  <% else %>
    <%= t('revs.admin.no_users_found', :with_email_address => @search) if @search %>
  <% end %>

</div>

<%= render :partial => 'devise/shared/show_admin_sidebar' %>
